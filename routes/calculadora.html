<svelte:head>
	<title>Calculadora</title>
</svelte:head>

<h1>Calculadora de Hor√°rio de Vistorias</h1>

<div>
	<button id="vistoriado" on:click="add('N')">N</button>
	<button id="fechado" on:click="add('F')">F</button></div>


<table>
	<tr>
		<th>Folha</th>
		<th>Linha</th>
		<th>Tipo</th>
		<th>Hora</th>
	</tr>
	{#each vistorias as vistoria}
	{#if vistoria.folha > 1 && vistoria.linha === 1}
	<tr>
		<td>-</td>
		<td>-</td>
		<td>-</td>
		<td>-</td>
	</tr>
	{/if}
	<tr>
		<td>{vistoria.folha}</td>
		<td>{vistoria.linha}</td>
		<td>{vistoria.tipo}</td>
		<td>{vistoria.hora}</td>
	</tr>
	{/each}
</table>


<script>
	var moment = require('moment');

	export default {
		data() {
			return {
				folha: 1,
				linha: 1,
				vistorias: []
			};
		},
		methods: {
			add(tipo) {
				const { folha, linha, vistorias } = this.get();
				this.set({ vistorias: vistorias.concat({ folha: folha, linha: linha, tipo: tipo, hora: moment().format('LT') }) });
				this.set({ linha: linha + 1 });
				if (linha >= 20) {
					this.set({ folha: folha + 1 });
					this.set({ linha: 1 });
				}
			}
		},
	};
</script>